--- src/PCIE/driver_fw/driver/aic8800/aic8800_fdrv/rwnx_rx.c
+++ src/PCIE/driver_fw/driver/aic8800/aic8800_fdrv/rwnx_rx.c
@@ -1507,7 +1507,11 @@ check_len_update:
         hdr = (struct ieee80211_hdr *)(skb->data + msdu_offset);
         rwnx_vif = rwnx_rx_get_vif(rwnx_hw, hw_rxhdr->flags_vif_idx);
         if (rwnx_vif) {
+#if LINUX_VERSION_CODE < KERNEL_VERSION(6, 17, 0)
             cfg80211_rx_spurious_frame(rwnx_vif->ndev, hdr->addr2, GFP_ATOMIC);
+#else
+            cfg80211_rx_spurious_frame(rwnx_vif->ndev, hdr->addr2, -1, GFP_ATOMIC);
+#endif
         }
         rwnx_ipc_buf_e2a_sync_back(rwnx_hw, ipc_buf, sync_len);
         rwnx_ipc_rxbuf_repush(rwnx_hw, ipc_buf);
@@ -1555,7 +1559,11 @@ check_len_update:
 
                 if (hw_rxhdr->flags_is_4addr && !rwnx_vif->use_4addr) {
                     cfg80211_rx_unexpected_4addr_frame(rwnx_vif->ndev,
+#if LINUX_VERSION_CODE < KERNEL_VERSION(6, 17, 0)
                                                        sta->mac_addr, GFP_ATOMIC);
+#else
+                                                       sta->mac_addr, -1, GFP_ATOMIC);
+#endif
                 }
             }
 
--- src/PCIE/driver_fw/driver/aic8800/aic8800_fdrv/rwnx_rx.c
+++ src/PCIE/driver_fw/driver/aic8800/aic8800_fdrv/rwnx_rx.c
@@ -2372,7 +2372,11 @@ check_len_update:
 		hdr = (struct ieee80211_hdr *)(skb->data + msdu_offset);
 		rwnx_vif = rwnx_rx_get_vif(rwnx_hw, hw_rxhdr->flags_vif_idx);
 		if (rwnx_vif) {
+#if LINUX_VERSION_CODE < KERNEL_VERSION(6, 17, 0)
 			rwnx_cfg80211_rx_spurious_frame(rwnx_vif->ndev, hdr->addr2, GFP_ATOMIC);
+#else
+			rwnx_cfg80211_rx_spurious_frame(rwnx_vif->ndev, hdr->addr2, -1, GFP_ATOMIC);
+#endif
 		}
 		goto end;
 	}
@@ -2651,7 +2655,11 @@ check_len_update:
 
 				if (hw_rxhdr->flags_is_4addr && !rwnx_vif->use_4addr) {
 					rwnx_cfg80211_rx_unexpected_4addr_frame(rwnx_vif->ndev,
+#if LINUX_VERSION_CODE < KERNEL_VERSION(6, 17, 0)
 													   sta->mac_addr, GFP_ATOMIC);
+#else
+													   sta->mac_addr, -1, GFP_ATOMIC);
+#endif
 				}
 			}
 
